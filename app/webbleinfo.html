<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8"/>
		<meta name="application-name" content="Webble World: Webble Information"/>
		<meta id="meta_description" name="description" content="Information about a specific Webble"/>
		<meta name="author" content="Micke Nicander Kuwahara"/>
		<meta name="revised" content="M.N.K., March 2014"/>
		<meta id="meta_keywords" name="keywords" content="Webble World, Universe, Webbles, Webbling, Meme Media, IntelligentPad, IntelligentBox, Micke Nicander Kuwahara, Yuzuru Tanaka, configure, edit, attach, detach, object"/>
		<meta name="generator" content="WebStorm 2016.2"/>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="google-site-verification" content="makSg-XnaN-RDJxY0CWDn3mp8GrCzwz3nD0frGGdRUk" />
		<meta property="og:title" content="Webble World 3.1: Webble Information" />
		<meta property="og:image" content="https://wws.meme.hokudai.ac.jp/images/icons/webbleworldIcon2_lg.png" />
		<meta property="og:description" content="A Webble object created to be used, manipulated, altered and improved by any online Internet user inside the Webble World online application (with little or no programming)." />
		<meta property="og:url" content="https://wws.meme.hokudai.ac.jp/" />

		<title id="WebPageTitle">Webble World - Webble Information Page</title>

		<!--
	   ===========================================================================================
	   // Webble World
	   // [IntelligentPad system for the web]
	   // Copyright (c) 2010 Micke Nicander Kuwahara, Giannis Georgalis, Yuzuru Tanaka in Meme Media R&D Group of Hokkaido University
	   // v3.0 (2013), v3.1(2015)
	   //
	   // Project Leader & Lead Meme Media Architect: Yuzuru Tanaka
	   // Webble System Lead Architect & Developer: Micke Nicander Kuwahara
	   // Server Side Developer: Giannis Georgalis
	   // Additional Support: Jonas Sjöbergh
	   //
	   // This file is part of Webble World (c).
	   // ******************************************************************************************
	   // Webble World is licensed under the Apache License, Version 2.0 (the "License");
	   // you may not use this file except in compliance with the License.
	   // You may obtain a copy of the License at
	   //
	   // http://www.apache.org/licenses/LICENSE-2.0
	   //
	   // Unless required by applicable law or agreed to in writing, software
	   // distributed under the License is distributed on an "AS IS" BASIS,
	   // WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
	   // See the License for the specific language governing permissions and
	   // limitations under the License.
	   // ******************************************************************************************
	   // The use of the word "Webble" or "webble" for the loadable meme media objects are limited
	   // only to objects that actually loads in this original Webble World Platform. Modifications
	   // of the meme media object code which leads to breaking of compatibility with the original
	   // Webble World platform, may no longer be refered to as a "Webble" or "webble".
	   // ******************************************************************************************
	   //===========================================================================================
	   -->

		<!--===========================================================================================
		// Webbles are interactive digital objects that resides inside Webble World which is a new
		// web-based knowledge media architecture, available through an Internet browser, that
		// allows us, not only to publish compound documents with or without embedded services and
		// tools into a world-wide shared repository like the Web, but also to reedit any compound
		// documents available from such a shared repository, through direct manipulations, and
		// through composition of new compound documents for local reuse and for publication to the
		// shared repository. The reediting of compound documents denotes the extraction and
		// recombination of their visual portions to compose a new compound document with a new
		// layout and new interoperability of the extracted components. A huge variety of objects
		// ranging from traditional web documents with text and images, to interactive tools,
		// virtual labs, games and community corners can be created and recreated with these
		// building blocks of "meme Lego™".
		//===========================================================================================-->

		<!-- Favicon -->
		<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />

		<!-- Stylesheets -->
		<!--Resets HTML5 Tags-->
		<link rel="stylesheet" type="text/css" href="styles/imported/reset.min.css">

		<!-- CSS from installed libraries -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
		<link rel="stylesheet" href="bower_components/font-awesome/css/font-awesome.css">

		<!--Main App styles-->
		<!-- build:css styles/platform.css -->
		<link rel="stylesheet" href="styles/main.css">
		<link rel="stylesheet" href="styles/platform.css"/>
		<!-- endbuild -->

		<!-- 3rd Party JavaScript Libraries, JQuery etc -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

	</head>

	<!--===========================================================================================
	// This is the Webble Info file, it exists mainly to let all search engines have something to
	// find that relates to each Webble so that one can "Google" for individual Webbles.
	//===========================================================================================-->
	<body style="display:none; margin: auto; width: 70%; max-width: 1500px;">


		<!--=====================================================================================
		// If the browser does not allow JavaScript or is just way to old and worthless the
		// application can not be run at all, but we can still be nice about it and display a
		// normal html page with some info which runs only if javascript is disabled or otherwise
		// unavailable.
		//=====================================================================================-->
		<!--[if lt IE 9]>
		<script src="bower_components/es5-shim/es5-shim.js"></script>
		<script src="bower_components/json3/lib/json3.min.js"></script>
		<![endif]-->

		<!--[if lt IE 7]>
		<p class="browsehappy"><span translate>You are using an </span><strong><span translate>outdated</span></strong><span translate> browser. Please </span><a href="http://browsehappy.com/"><span translate>upgrade your browser</span></a><span translate> to improve your experience.</span></p>
		<![endif]-->

		<noscript>
			<p>Webble World is a Highly advanced modern web application and it requires JavaScript to run properly, and since this browser does not allow that we suggest that you do something about it or return to the previous millennial where you belong. ;-) </p>

			<p>
				<span translate>Best Regards/</span><br/>
				<span translate>Webble World - development team</span>
			</p>
		</noscript>
		<!--=============================================================================-->



		<!--=====================================================================================
		// This is where all Webble data will be displayed after it has been retrieved from the server
		//====================================================================================-->
		<div class="wblwrldform-main" style="padding-left: 40px; min-width: 600px;">
			<h1 id="pageTitle">Webble World 3.1: Webble Information Page</h1>
			<hr style="border: 1px double black; height: 2px;  margin: 0; padding: 0; width: 98%;">


			<div class="row keepTheDistanceBelow" style="width: 98%;">
				<div class="col-xs-12"><h2 id="displayname" style="font-weight: bold;"></h2></div>
			</div>

			<div class="keepTheDistanceBelow dividerLineAbove" style="font-size: 18px; width: 98%;">
				<div class="row">
					<div class="col-xs-12" style="text-align: center;">
						<a id="wblLink" class="btn btn-primary btn-lg" href="#" role="button"></a>
					</div>
				</div>
			</div>

			<div class="keepTheDistanceBelow dividerLineAbove" style="font-size: 18px; width: 98%;">
				<div class="row">
					<div class="col-xs-12" id="wblImg"></div>
				</div>
			</div>

			<div class="keepTheDistanceBelow dividerLineAbove" style="font-size: 18px;  width: 98%;">
				<div class="row keepTheDistanceBelow dividerLineBetween">
					<div class="col-xs-3"><span class="formTitle">Display Name:</span></div>
					<div class="col-xs-7"><span id="displayname2" style="font-weight: normal;"></span></div>
					<div class="col-xs-2"><span style="padding-left: 3px; padding-right: 3px; background-color: white; border: 1px solid #0000ff; font-size: 0.9em; cursor:pointer;" data-toggle="tooltip" data-placement="left" title="This is the display name for this Webble when published">?</span></div>
				</div>

				<div class="row keepTheDistanceBelow dividerLineBetween">
					<div class="col-xs-3"><span class="formTitle">Webble Description:</span></div>
					<div class="col-xs-7"><span id="description" style="font-weight: normal;"></span></div>
					<div class="col-xs-2"><span style="padding-left: 3px; padding-right: 3px; background-color: white; border: 1px solid #0000ff; font-size: 0.9em; cursor:pointer;" data-toggle="tooltip" data-placement="left" title="This is the description of this Webble">?</span></div>
				</div>

				<div class="row keepTheDistanceBelow dividerLineBetween">
					<div class="col-xs-3"><span class="formTitle">Webble Keywords:</span></div>
					<div class="col-xs-7"><span id="keywords" style="font-weight: normal;"></span></div>
					<div class="col-xs-2"><span style="padding-left: 3px; padding-right: 3px; background-color: white; border: 1px solid #0000ff; font-size: 0.9em; cursor:pointer;" data-toggle="tooltip" data-placement="left" title="This is the keywords selected for this Webble Definition">?</span></div>
				</div>

				<div class="row keepTheDistanceBelow dividerLineBetween">
					<div class="col-xs-3"><span class="formTitle">Webble Id:</span></div>
					<div class="col-xs-7"><span id="defid" style="font-weight: normal;"></span></div>
					<div class="col-xs-2"><span style="padding-left: 3px; padding-right: 3px; background-color: white; border: 1px solid #0000ff; font-size: 0.9em; cursor:pointer;" data-toggle="tooltip" data-placement="left" title="This is the unique name of the Webble definition this Webble was given when published.">?</span></div>
				</div>

				<div class="row keepTheDistanceBelow dividerLineBetween">
					<div class="col-xs-3"><span class="formTitle">Webble Author:</span></div>
					<div class="col-xs-7"><span id="author" style="font-weight: normal;"></span></div>
					<div class="col-xs-2"><span style="padding-left: 3px; padding-right: 3px; background-color: white; border: 1px solid #0000ff; font-size: 0.9em; cursor:pointer;" data-toggle="tooltip" data-placement="left" title="This is the user name of the author for this Webble definition">?</span></div>
				</div>

				<div class="row keepTheDistanceBelow dividerLineBetween">
					<div class="col-xs-3" style="padding-top: 11px;"><span class="formTitle" style="font-size: 18px;">Rating:</span></div>
					<div class="col-xs-2" style="padding-top: 10px;"><div id="stars"></div></div>
					<div class="col-xs-5" style="padding-top: 11px;"><div id="ratingInfo"></div></div>
					<div class="col-xs-2" style="padding-top: 11px;"><span style="padding-left: 3px; padding-right: 3px; background-color: white; border: 1px solid #0000ff; font-size: 0.9em; cursor:pointer;" data-toggle="tooltip" data-placement="left" title="This is the average rating given to this Webble after online users have voted on it.">?</span></div>
				</div>

				<div class="row keepTheDistanceBelow">
					<div class="col-xs-3"><span class="formTitle">Included Webble Templates:</span></div>
					<div class="col-xs-7"><span id="templateInfo" style="font-weight: normal;"></span></div>
					<div class="col-xs-2"><span style="padding-left: 3px; padding-right: 3px; background-color: white; border: 1px solid #0000ff; font-size: 0.9em; cursor:pointer;" data-toggle="tooltip" data-placement="left" title="These are the names (and version) for all the Webble templates this Webble is containing.">?</span></div>
				</div>
			</div>

			<div class="keepTheDistanceBelow dividerLineAbove" style="font-size: 18px; width: 98%;">
				<div class="row">
					<div class="col-xs-12" style="text-align: center;">
						<a id="wblLink2" class="btn btn-primary btn-lg" href="#" role="button"></a>
					</div>
				</div>
			</div>

			<div class="dividerLineAbove">
				<div class="row">
					<div id="infoMsg" class="col-xs-12" style="font-size: 16px; font-weight: bold; color: red; text-align: left; height: 40px;">
					</div>
				</div>
			</div>
		</div>
		<!--=============================================================================-->


		<!--===========================================================================================
		// JavaScript Functions and ajax call for getting specified Webble from Webble World Server
		//==========================================================================================-->
		<script type="text/javascript">

			//=== PROPERTIES ================================================================
			var textParts = {
				starRatingTxt: [
					"Terrible",
					"Very Bad",
					"Bad",
					"Could be better",
					"Fairly Ok",
					"Good",
					"Very Good",
					"Great!",
					"Amazing!",
					"Masterpiece!"
				],
				rateTxtVoters: "votes"
			};


			//=== PRIVATE FUNCTIONS ===========================================================================================

			//========================================================================================
			// Get Webble Data
			// Asks the server for a specified webble definition file string and when found
			//========================================================================================
			var getWebbleData =  function(whatWblDefId) {
				if(whatWblDefId != ""){
					$.ajax({url: window.location.origin + '/api/webbles/' + encodeURIComponent(whatWblDefId),
						success: function(wblData){
							$("#WebPageTitle").text("Webble Information: " + wblData.webble.displayname);
							$("#meta_description").attr("content", $("#meta_description").attr("content") + ": " + wblData.webble.displayname)
							$("#meta_keywords").attr("content", $("#meta_keywords").attr("content") + ", " + wblData.webble.keywords)

							$("#wblLink").text("Load '" + wblData.webble.displayname + "' in Webble World");
							$("#wblLink").attr("href", window.location.origin + "/#/app?webble=" + wblData.webble.defid);
							$("#displayname").text(wblData.webble.displayname);
							$("#wblImg").html('<img  class="img-responsive" src="' + wblData.webble.image + '" style="border: 1px solid #000000; max-height: 400px;">');
							var starRatingHtmlStr = '';
							for(var i = 0; i < 10; i++){
								if(wblData.rating > i){
									starRatingHtmlStr += '<img src="images/starOn.png" title="' + textParts.starRatingTxt[i] + '" style="margin-left: -1px; width: 20px; height: 20px;">';
								}
								else{
									starRatingHtmlStr += '<img src="images/starOff.png" title="' + textParts.starRatingTxt[i] + '" style="margin-left: -1px; width: 20px; height: 20px;">';
								}
							}
							$("#stars").html(starRatingHtmlStr);
							$("#ratingInfo").html('<span style="font-size: 16px;">' + (wblData.rating > 0 ? textParts.starRatingTxt[wblData.rating-1] : "Unrated") + ' (' + (wblData.rating).toFixed(2) + ') [' + wblData.rating_count + ' ' +  textParts.rateTxtVoters + ']</span>');
							$("#displayname2").text(wblData.webble.displayname);
							$("#defid").text(wblData.webble.defid);
							$("#description").text(wblData.webble.description);
							$("#keywords").text(wblData.webble.keywords);
							$("#author").text(wblData.webble.author);
							var allWblTemplates = getAllUniqueTemplatesWithVersion(wblData);
							removeDupTemplates(allWblTemplates);
							var templateInfoStr = "";
							for(var i = 0; i < allWblTemplates.length; i++){
								if(i > 0){ templateInfoStr += ", "; }
								templateInfoStr += (allWblTemplates[i].templateid + " (v. " + allWblTemplates[i].templaterevision + ")");
							}
							$("#templateInfo").text(templateInfoStr);
							$("#wblLink2").text("Load '" + wblData.webble.displayname + "' in Webble World");
							$("#wblLink2").attr("href", window.location.origin + "/#/app?webble=" + wblData.webble.defid);

							$('body').show();
						},
						error: function(data){
							$("#displayname").css("text-align", "center");
							$("#displayname").html("*ERROR*<br>----------------------------------------------------------------<br>No Webble by that name/id exists<br>----------------------------------------------------------------<br>*ERROR*");
							$("#wblLink").css("display", "none");
							$("#wblLink2").css("display", "none");
							$("#infoMsg").text(data.statusText + ": " + data.responseText);
							$('body').show();
						}
					});
				}
				else{
					$("#displayname").css("text-align", "center");
					$("#displayname").html("*EMPTY QUERY*<br>----------------------------------------------------------------<br>No Webble query applied to the URL<br>----------------------------------------------------------------<br>*EMPTY QUERY*");
					$("#wblLink").css("display", "none");
					$("#wblLink2").css("display", "none");
					$("#infoMsg").text("Add a query to the url of this page '?wbl=WEBBLE_ID' to get information about the Webble with that name/id");
					$('body').show();

					$('body').show();
				}
			};
			//========================================================================================


			//========================================================================================
			// Remove Duplicate Templates
			// iterates the list and remove all duplicate templates
			//========================================================================================
			function removeDupTemplates(array) {
				var list = {}, id;
				for (var i = 0; i < array.length; i++) {
					id = array[i].templateid;
					if (id in list) {
						// found a dup id, remove it
						array.splice(i, 1);
						// correct for loop index so it will process the item
						// that just moved down in place of the one we just removed
						--i;
					} else {
						// add the id to our map
						list[id] = true;
					}
				}
			}
			//========================================================================================


			//========================================================================================
			// All Values by Key
			// retreives all values by a certain key in a specific object and return them as an array.
			//========================================================================================
			var getAllUniqueTemplatesWithVersion = function(obj) {
				var templateList = [];
				var template = {};

				for (var key in obj) {
					if (!obj.hasOwnProperty(key)){ continue; }

					if (typeof obj[key] == 'object') {
						var moreVals = this.getAllUniqueTemplatesWithVersion(obj[key]);
						if(moreVals.length > 0){
							templateList = templateList.concat(moreVals);
						}
					}
				}

				if(obj != null && obj['templateid'] != undefined && obj['templateid'] != "bundleTemplate"){
					templateList.push({'templateid': obj['templateid'], 'templaterevision': obj['templaterevision']});
				}

				return templateList;
			};
			//========================================================================================


			//========================================================================================
			// Get Requested Webble Definition Id
			// extract the webble def id part included in the query of the url.
			//========================================================================================
			var getRequestedWblDefId = function () {
				var wblDefId = "";
				var query = window.location.search.substring(1);
				var vars = query.split("&");
				for(var i =0; i < vars.length; i++) {
					var pair = vars[i].split("=");
					// If first entry with this name
					if (pair[0] === "wbl" && pair[1] != "") {
						wblDefId = pair[1];
					}
				}
				return wblDefId;
			};
			//========================================================================================

			//******************************************************************************************************************
			//=== CTRL MAIN CODE ===============================================================================================
			//******************************************************************************************************************
			$(document).ready(function(){
				$('[data-toggle="tooltip"]').tooltip();
			});

			getWebbleData(getRequestedWblDefId());

		</script>
		<!--=============================================================================-->

	</body>
</html>
<!--=================================================================================================================-->
